<html>
<head>
	 <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
	 <meta name="Content-language" content="sk"> 
 	 <title>Excel - práca s databázou - zoznamy</title>	
 	 <LINK href="css/style.css" type="text/css" rel=stylesheet>	 
</head>

<body>
<h3>Excel - práca s databázou - zoznamy</h3>
<H3>Opakovanie</h3>
<ul><li>Ako sa zadávajú vzorce do bunky
	<li>Èo je absolútna a èo relatívna adresa
	<li>Aké aritmetické operátory máme k dispozícii
	<li>Aké relaèné operátory máme k dispozícii
	<li>Èo sa stane, ak bunku na ktorú ukazuje nejakı vzorec premiestnim inam?
	<li>Aké sú monosti zada do bunky funkciu SUMA
	<li>Ako fungujú funkcie SUMIF a COUNTIF
	<li>Pouitie logickıch funkcií
	<li>Dátumové funkcie
</ul>	
Ak uívate¾ovi nepostaèuje nástroje pre prácu s bunkami, blokmi, listami a potrebuje ïalšie
nástroje môe siahnu po databázovıch nástrojoch, ktoré sú podobné s nástrojmi v databázovıch
systémoch. Oproti "exceláckym" sú komfortnejšie" a mohutnejšie, ale uívate¾ musí údaje v tabu¾ke
prispôsobi databázovım poiadavkám. 
<br>Èo získame - lepšie vyh¾adávanie, sumarizovanie, filtrovanie.
<h2>Pojmy</h2>
<dl><dt>Databáza
	<dd>Databáza je oblas buniek s hlavnımi dátami (zoznamom) a pomocnımi dátami (kritéria, formuláre). 
	<dt>Zoznam
	<dd>Hlavné dáta v súvislom celku, kde riadky predstavujú záznamy a ståpce údajov sú polia. 
		Prvı riadok zoznamu obsahuje popisky-hlavièky polí. Údaje v jednom ståpci by mali by 
		rovnakého typu. Excel chápe pole ako oblas od hlavièky	po prvı prázdny údaj.
		<br>Názvy ståpcov (popisky) sa pouívajú ako parametre funkcií. Databázové funkcie pracujú s celımi poliami.
	<dt>Kritéria
	<dd>V databázovıch funkciách sa kritéria pre podmienené súèty, vyh¾adávanie nepíšu do vzorca ale sú súèasou
		databázy a sú zapísané na niektorom liste (väèšinou nad zoznamom) 
	<dt><font size="+1" color="Blue"><B>Pravidlá pre vytváranie zoznamu na liste</b></font>
	<dd>Na jednom liste pouívajte len jeden zoznam - niektoré funkcie to vyadujú (napríklad filtrovanie).
		<br>Podobné poloky usporiadajte do jedného ståpca.
		<br>Oddelte zoznam od ostatnıch dát, medzi zoznamom a ostatnımi údajmi v liste nechajte aspoò jeden 
		prázdny ståpec a jeden prázdny riadok. Aplikácia Excel môe potom pri triedení, filtrovaní a vkladaní 
		automatickıch súhrnov omnoho ¾ahšie urèi zoznam.
		<br>ïalšie údaje na liste (okrem zoznamu) umiestòujte nad zoznam alebo pod, predídeme problémom pri
		vyhadzovaní riadkov resp. ich vkladaní. Tie pri filtrovaní zoznamu takto zostanú viditelné.
		<br>Hlavièky neodde¾ujte od dát prázdnymi riadkami ale ohranièením buniek.
		<br>Ståpce zoznamu neoode¾ujte prázdnymi ståpcami ale ohranièením buniek.
		<br>V bunkách nevkladajte pred a za dáta medzery - kôli triedenie, vyh¾adávaniu,...
</dl>  
<hr>
<h2>Práca s databázou</h2>
<dl><dt>Triedenie pod¾a jedného ståpca
	<dd>Majme nasledovnú tabu¾ku:<br><br>
		<table border="2" bgcolor=#ccffcc>
		<tr><td colspan="5" bgcolor=#ccffcc align="center">Beh na 1km</tr>
		<tr bgcolor=#99ff99><td> èíslo <td> meno <td> priezvisko <td> kraj <td> èas</tr>
		<tr><td bgcolor=#99ff99> 6 <td> Richard <td> Tomaj <td> Banskobystrickı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 1 <td> Anton <td> Hrdı <td> Bratislavskı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 2 <td> Peter <td> Maroš <td> Bratislavskı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 7 <td> Martin <td> Baroš <td> Košickı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 5 <td> Michal <td> Gašpar <td> Nitriansky <td>0:00	</tr>
		<tr><td bgcolor=#99ff99> 8 <td> Juraj <td> Sépeši <td> Prešovskı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 3 <td> Ján <td> Puchı <td> Trenèiansky <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 4 <td> Peter <td> Raška <td> Trnavskı <td>0:00</tr>
		<tr><td bgcolor=#99ff99> 9 <td> Martin <td> Jánošík <td> ilinskı <td>0:00</tr>
		</table>	
		Nako¾ko máme splnené podmienky pre zoznam (súvislos, pomenované ståpce) môme celú
		tabu¾ku triedi nasledovne:
		<ol>
		<li>Presunieme kurzor na pole pod¾a ktorého ideme triedi
		<li>Stlaèíme tlaèidlo <img src="obr/a-z.gif" width="30" height="29" border="0" alt="" align="middle">,
			ktoré poprehadzuje riadky v zozname tak, aby vo zvolenom poli boli utriedené vzostupne. Obdobne tlaèidlom
			<img src="obr/z-a.gif" width="30" height="29" border="0" alt=""> dosiahneme popreskupovanie riadkov tabu¾ky
			, e pole je utriedené zostupne. 
		</ol>
	<dt>Triedenie pod¾a viacerıch ståpcov
	<dd>Triedi mono pod¾a viacerıch úrovní - ak pod¾a jedného k¾úèa sú rovnaké hodnoty nastúpi pravidlo druhého atd.
		<br>Postup:
		<ol>
		<li>Presunieme kurzor do zoznamu
		<li>Údaje -> Zoradi a filtrova -> Zoradi 
		<li>Zvolím poradie k¾úèov pod¾a ktorıch sa tabu¾ka utriedi
		</ol>
		V prípade ak je obsah k¾úèa špeciálny (dni v tıdni, mesiace, nejakı vlastnı...) zvolím v ståpci PORADIE zoznam
		pod¾a ktorého sa bude triedi.

	<dt>Vyh¾adávanie/filtrovanie	
	<dd>Na vyh¾adávanie záznamov (riadkov) spåòajúcich urèité pravidlá pouívame filtre. 
		Údaje, ktoré podmienku nespåòajú, vidie nebudeme.
		<br>Postup:
		<ol>
		<li>Presuniem kurzor do zoznamu (tabu¾ky)
		<li>Zvolím cez menu Údaje -> Zoradi a filtrova -> Filter 
		</ol>
		Pri kadej hlavièke po¾a sa zjaví malá šipka, cez ktorú môme urèova, aké záznamy
		sa majú zobrazi. Ak nastavíme kritéria vo viacerıch poliach zobrazia sa len tie záznamy
		ktoré vyhovujú všetkım pravidlám. Ak zvolím kritérium "Filter textu" resp. "Filter èísel" môem nastavi aj iné pravidlá
		ako pravidlá na rovnos. Ak chcem kritéria urèova len v jednom/niektorıch ståpci tak zvolenı ståpec oznaèím do bloku pred vo¾bou filtra.
		<dl>
		<dt>Úlohy na precvièenie:
		<dd><table cellspacing="20"><tr><td>
	       	<img src="obr/stastny.gif" border="0" alt="" height="50">
			<td><ol><li>Naèítajte tieto <a href="priklady/z1992.xls" target="_blank">data</a> a pomocou filtra zistite
						<ul type="disc"><li>ktorí iaci 22. mája maturovali na samé 1
							<li>ktorí iaci (iak) narodenı v Handlovej prišiel zo ZŠ S.Chal. 1
							<li>ktorí iaci z tried B,C,E nedostali na mature ani jednu jednotku
						</ul>
				</ol></tr>		
			</table>		
		</dl>	
</dl>
Pomocou jednoduchého filtra mono kombinova podmienky pre viaceré ståpce ale len spojkou AND. Pokia¾ potrebujeme vytvori podmienku, ktorá obsahuje 
spojku OR musíme ís do rozšíreného filtra.
<dl>
	<dt>Rozšírenı filter:
	<dd>V rozšírenom filtri sa pouívajú oblasti kritérií. Aktivujeme ho cez menu Údaje -> Zoradi a filtrova -> Rozšírené,
		zvolíme zoznam (ten by mal excel nájs sám) a oblas kritérií. Funguje ako automatickı filter, len monosti kombinovania podmienok sú bohatšie.
		<br>Pozn. 1 
		<br>Ak pri aktívnom filtri zmeníme poloky kritérií na filtrovanı zoznam to nemá vplyv (musíme filter nanovo otvori).
		<br>Pozn. 2 
		<br>V rámci listu mono vyfiltrované záznamy kopírova a vytvori ïalší zoznam alebo vymaza.
					
	<dt><font size="+1" color="Blue"><B>Tvorba kritérií:</b></font>
	<dd>1. ... Nad tabu¾kou-zoznamom vytvoríme nieko¾ko prázdnych riadkov
		<br>2. ... Do vo¾nıch riadkov okopírujeme popisy polí - hlavièky
		<br>3. ... Pod hlavièky zadávame kritéria
		<br>...... kritériom môe by hodnota (Trenèiansky) alebo podmienka (>Banskobystrickı)
		<br>4. ... Kombinovanie kritérií
		<br>...... Viaceré kritéria uvedené v jednom riadku sa spájajú operátorom AND 
		<br>...... Kritéria uvedené v riadkoch sa spájajú operátorom OR
		<br>...... Ak v niektorej bunke podmienka nie je (prázdna bunka) tak takejto podmienke vyhovujú všetky záznamy
		<br><br>Príklady kritérií pre tabu¾ku "Beh na 1 km" uvedenú hore:   	
		<table><tr><td>
					<table border="2" bgcolor=#999999>
					<tr bgcolor=#cccccc><td> èíslo <td> meno <td> priezvisko <td> kraj <td width="36"> èas</tr>
							<tr bgcolor=#eeeeee><td>       <td>      <td>            <td> T* <td> &nbsp; &nbsp; &nbsp; </tr>
					</table>
					<td>Tomuto kritériu vyhovujú záznamy s krajom zaèínajúcim na T</tr>
				<tr><td>	
					<table border="2" bgcolor=#999999>
					<tr bgcolor=#cccccc><td> èíslo <td> meno <td> priezvisko <td> kraj <td width="25"> èas</tr>
					<tr bgcolor=#eeeeee><td> >5      <td>      <td>            <td><td> &lt;3:00 </tr> 
					</table>
					<td>Tomuto kritériu vyhovujú záznamy s èíslom > 5 <br><b>a zároveò</b> èasom &lt; 3min</tr>
				<tr><td>	
					<table border="2" bgcolor=#999999>
					<tr bgcolor=#cccccc><td> èíslo <td> meno <td> priezvisko <td> kraj <td width="36"> èas</tr>
							<tr bgcolor=#eeeeee><td> <td> <td> <td> T* <td> &nbsp; &nbsp; &nbsp;</tr> 
							<tr bgcolor=#eeeeee><td> <td> <td> <td> B* <td> &nbsp; &nbsp; &nbsp; </tr>
					</table>
					<td>Tomuto kritériu vyhovujú záznamy s krajom zaèínajúcim na T <b>alebo</b> B</tr>
				<tr><td>	
					<table border="2" bgcolor=#999999>
					<tr bgcolor=#cccccc><td> èíslo <td> meno <td> priezvisko <td> kraj <td width="36"> èas</tr>
							<tr bgcolor=#eeeeee><td> <td>M* <td> <td> <td> &nbsp; &nbsp; &nbsp;</tr>
							<tr bgcolor=#eeeeee><td> <td>   <td>M* <td> <td> &nbsp; &nbsp; &nbsp;</tr>
					</table>
					<td>Tomuto kritériu vyhovujú záznamy  
						<br>s menom <b>alebo</b> priezviskom zaèínajúcim na M </tr>
			</table>

		<dl><dt>Úlohy na precvièenie:
    			<dd><table cellspacing="20"><tr><td>
	        	<img src="obr/stastny.gif" border="0" alt="" height="50">
				<td><ol><li>Naèítajte tieto <a href="priklady/z1992.xls" target="_blank">data</a> a pomocou filtra okopírujte záznamy
							<ul type="disc"><li>chlapcov ktorí maturovali 22. mája alebo 23. mája na samé 1
								<li>ktorí iaci narodenı v Handlovej prišli zo ZŠ S.Chal. 1 alebo 2 
								<li>ktorí iaci z tried B,C,E nedostali na mature ani jednu jednotku alebo dostali štvorku
							</ul>
							na pomocnı list Vıber.
					</ol></tr>		
					</table>		
		</dl>					
	<dt>Formulár:
	<dd>Pomocou formulára je moné databázu prezera, editova záznamy, ruši a pridáva záznamy. Je moné nastavi si filter.	Nako¾ko
		od verzie 2007 u nie súèasou ponuky, nebudem ho podrobnejšie popisova. Pre uívate¾ov, ktorı si na prácu so vstupnım formulárom
		zvykli, je monos aktivova formulár len postup je dos "èudesnı".
		<ol><li>prejdeme do "prispôsobenia rıchleho prístupu"
			<li>zvolíme "Ïalšie príkazy"
			<li>v rozba¾ovacej ponuke zvolíme "Všetky príkazy"
			<li>nájdeme text "Formulár"
			<li>na paneli "Rıchly prístup" pribudne ikonka "Formulár"
			<li>keï sme v zozname nejakej databázy a aktivujeme formulár, môme prezera, filtrova, editova zoznam databázy
		</ol>	  
	<dt><font size="+1" color="Blue"><B>Databázové funkcie:</b></font>
	<dd>Databázové funkcie (skrátene nazıvané Dfunkcie) nám rozširujú monosti na matematické vıpoèty
		s tabu¾kou databázy. Syntax Dfunkcií je podobnı: <font color="Blue">názov( databáza; pole; kritéria)</font>
		<br><font color="Blue">názov</font> ... je meno excelom definovane funkcie (napr. Dmax)
		<br><font color="Blue">databáza</font> ... je oblas dát s hlavièkami polí - nemusí ís o celú tabu¾ku - obyèajne je zadaná menom (pozri pomenovávanie oblastí v úvode) alebo napíšeme slovo Databaza a on sa s tym nejak zrovná (ak sme v zozname databázy)
		<br><font color="Blue">pole</font> ... názov ståpca ako text (v úvodzovkách) alebo poradové èíslo ståpca v databáze, ktorého sa funkcia bude tıka 
		<br><font color="Blue">kritéria</font> ... oblas kritérií, môe ukazova aj na prázdne bunky, alebo celı zoznam (pravidlá pre kritéria pozri hore)
		<h3>Dfunkcie</h3>
		<dl><dt><font color="Red">Dmax, Dmin</font>
			<dd>Z daného ståpca vráti maximum, minimum (len zo záznamov vyhovujúcich kritériám)
				<br>Dmax(tabulka;"plat";tabulka) ... vráti maximálny plat zo ståpca plat 
				<br>Dmin(tabulka;"plat";tabulka) ... vráti minimálny plat zo ståpca plat 
		    <dt><font color="Red">DCount</font>
			<dd>Z daného ståpca vráti poèet èíselnıch poloiek, pole môe by vynechané, potom sa skúma celá databáza 
				<br>DCount(tabulka;"plat";tabulka) ... vráti poèet ¾udí so zadanım platom 
		    <dt><font color="Red">DCounta</font>
			<dd>Z daného ståpca vráti poèet neprázdnych poloiek, pole môe by vynechané, potom sa skúma celá databáza 
				<br>DCounta(tabulka;"meno";tabulka) ... vráti poèet ¾udí so zadanım menom 
		    <dt><font color="Red">Dsum, DAverage</font>
			<dd>Z daného ståpca vráti súèet, priemer 
				<br>DSum(tabulka;"plat";tabulka) ... vráti súèet platov 
				<br>DAverage(tabulka;"plat";tabulka) ... vráti priemernı plat
			<dt>Úlohy na precvièenie:
    		<dd><table cellspacing="20"><tr><td>
		       	<img src="obr/stastny.gif" border="0" alt="" height="50">
				<td><ol><li><a href="kratke/7_zoznamy.xls">Príklady</a>
						<li>Naèítajte tieto <a href="priklady/z1992.xls" target="_blank">data</a> a vytvorte na ïalšom liste nasledovnú súhrnnú tabu¾ku
							<table bgcolor=#eeeeee border="2">
								<tr><th colspan="6" bgcolor=#cccccc>Informatika</tr>
								<tr bgcolor=#cccccc><th>Trieda<th>20. mája<th>21. mája<th>22. mája<th>23. mája<th>Spolu</tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>A<td> <td> <td> <td> <td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>B<td><td><td><td><td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>C<td><td><td><td><td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>D<td><td><td><td><td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>E<td><td><td><td><td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>F<td><td><td><td><td> </tr>
								<tr bgcolor=#ffffff><th bgcolor=#cccccc>Spolu<td><td><td><td><td> </tr>
				</table>		
		</dl>					
</dl>
</body>
</html>
