<html>
<head>
	 <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
	 <meta name="Content-language" content="sk"> 
	<title>Excel-vzorce</title>
 	 <LINK href="css/style.css" type="text/css" rel=stylesheet>	 
</head>

<body>
<h2>Vzorce</h2>
<H3>Opakovanie</h3>
<ul><li>Ako sa zadávajú vzorce do bunky
	<li>Èo je absolútna a èo relatívna adresa
	<li>Aké aritmetické operátory máme k dispozícii
	<li>Aké relaèné operátory máme k dispozícii
	<li>Èo sa stane, ak bunku na ktorú ukazuje nejakı vzorec premiestnim inam?
</ul>	
<H3>Ako zada do bunky funkciu</H3>
(Pozn. V starších verziách Excelu bola snaha "poslovenèi" prípadne "poèešti" názvy niektorıch funkcií, èo viedlo ku zmätkom, 
 dnes sa názvy funkcií neprekladajú a píšeme ich v anglickom jazyku)
Excel nám na najbenejšie operácie s bunkami ponúka ve¾ké mnostvo funkcií - matematickıch, logickıch, dátumovıch, èasovıch, ...
ma ich zápis máme nasledovné monosti:
<dl><dt>Pomocou sprievodcu
	<dd>Funkcie mono do vzorca vloi pomocou sprievodcu - tlaèidlo <img src="obr/fx.gif" width="26" height="30" border="0" alt="" align="middle">
		Po stlaèení tohto tlaèítka získame nasledovné okno (obr.3):
		 <table cellspacing="20"><tr>
		 <td><img src="obr/funkcia1.jpg" width="387" height="317" border="0" alt=""> <br>obr.3
		 <td><img src="obr/funkcia2.jpg" width="466" height="219" border="0" alt=""> <br>obr.4
		 </tr>
		 </table>
		 Funkcie sú rozdelené do skupín a zoznam skupín je v ¾avom zozname, obsah jedného zoznamu je 
		 v pravom vıpise. Vo¾bu ktorı zoznam chcem ma otvorenı vpravo urobím jednoducho kliknutím myši naò.
		 Jeden zoznam má èastejšie pouitie a to "Naposledy pouité" a "Vše". Po prepnutí do pravého okna
		 staèí stlaèi prvé písmeno h¾adanej funkcie a potom klávesovımi šipkami si nájdeme h¾adanú funkciu
		 a stlaèíme Enter. Zobrazí sa nám pomocnı expert pomocou ktorého správne vyplníme parametre funkcie. 
		 Napr. pre funkciu Suma je to (obr.4). Do jednotlivıch okienok zadávame parametre, pod¾a nápovedy
		 ku kadému parametru v dolnej polovici okna. Na spodu okna máme aj aktuálny stav vısledku pri zvolenıch parametroch.
		 Parametrom väèšinou môe by bunka alebo oblas. Ak chceme oblas môeme ju priamo naklepa do cst. riadka
		 alebo stlaèíme èervenú šipku a pomom oznaèíme v dokumente poadovanú oblas. Ak parametrov môe by viac
		 budú vstupné riadky pribúda tım tempom ako ich zapåòame.
	<dt>Písaním vzorca
	<dd>písaním do vstupného riadku (písanie zaèneme stlaèením tlaèidla <img src="obr/rovnasa.gif" width="21" height="23" border="0" alt="" align="middle">). 
		<dl><dt>Zadávanie oblastí vo funkcii
			<dd><ul><li>samotná bunka ... SUM(C7) 
					<li>jedna oblas  ... SUM(B3:D5) 
					<li>oblasti oddelené bodkoèiarkou ... SUM(C7;B3:D5)
				</ul>
		</dl>				 			
    <dt>Funkcia SUM
	<dd>V praxi sa najviac stretávame s potrebou spoèíta údaje v riadku (ståpci) tabu¾ky 
		preto je tejto funkcii venované aj špeciálne tlaèítko v paneli nástrojov - je na òom 
		zobrazenı znak sumy <img src="obr/suma.gif" width="26" height="25" border="0" alt="" align="middle">. 
		Ak do tabu¾ky z predošlej kapitoly vloíme ešte jeden riadok získame nasledovnú tabu¾ku:
		<table>
			<tr><td>
			<table border="2" cellspacing="1" bgcolor="White">
			<tr><td bgcolor="Silver"> <th bgcolor="Silver">A<th bgcolor="Silver">B<th bgcolor="Silver">C</tr> 
			<tr><td bgcolor="Silver"> 1 <th>Meno<th>Plat<th>NovyPlat<th> </tr>
			<tr><td bgcolor="Silver"> 2 <td>Daniš<td>8500<td> ?</tr>
			<tr><td bgcolor="Silver"> 3 <td>Frano<td>7200<td> ?</tr>
			<tr><td bgcolor="Silver"> 4 <td>Gábor<td>7800<td> ?</tr>
			<tr><td bgcolor="Silver"> 5 <td>Maco<td>6900<td> ?</tr>
			<tr><td bgcolor="Silver"> 6 <td>Rak<td>8800<td> ?</tr>
			<tr><td bgcolor="Silver"> 7 <td>Spolu<td> ?<td> ?</tr>
			</table>
        	<td valign="top"> 
			<table border="2" cellspacing="1" bgcolor="White"> 
		 	<tr><th bgcolor="Silver"> G </tr>
		 	<tr><th>Percento rastu</tr>
		 	<tr><td>18 </tr>
		 	</table></tr>
		</table>
		<ul><li>Vıpoèet platu spolu bez funkcie - <span style="background:#cccccc"> =B2+B3+B4+B5+B6 </span>
		 			Tento spôsob je pouitelnı pre menší poèet argumentov, tie kadé pridanie-ubratie riadku 
					nás núti meni vzorec, èo je nepraktické.
		 	<li>Vıpoèet platu spolu s funkciou <b>SUM</b>
			 	<ul><li>nastavíme kurzor do políèka B7
					<li>stlaèíme tlaèítko <b>SUM</b> <img src="obr/sum.png" width="37" height="28" border="0" alt="" align="absmiddle">
					<li>Excel sa pokúsi oznaèi blok, ktorı chceme spoèíta
						<br> - ak s jeho návrhom súhlasíme stlaèíme Enter
						<br> - ak chceme sèítaè inı blok oznaèíme ho manuálne
					<li>Teraz si pozrieme vısledok - v bunke bude zapísane <span style="background:#cccccc">=SUM(B2:B7) </span>
						<br>èo vlastne znamená <b>SPOÈÍTAJ</b> bunky od B2 po B7 
				</ul>		
		</ul>
		 Ve¾kou vıhodou je, e ak v oblasti riadkov 2..7 pridáme resp. odstránime riadky náš vzorec sa "sám" upraví aby ukazoval správny vısledok.
		 Tento vzorec mono okopírova do bunky C7, lebo adresy spoèítavanej oblasti sú relatívne.
	   	<hr width="50%" size="2">
		<dt>Syntax,sémantika niektorıch funkcií
		<dd>
			<dl>
          		<dt style="color:green">SUM(zoznam oblastí oddelenıch bodkoèiarkou)<dd>
		      		Spoèíta všetky bunky všetkıch zadanıch oblastí, ak sú tam bunky textové nevadí, berie ich ako 0. 
			  		<br>Príklad SUM(a1;B2:C10)
          		<dt style="color:green">Average(zoznam oblastí oddelenıch bodkoèiarkou)
	  			<dd>Spoèíta všetky bunky všetkıch zadanıch oblastí a vydelí poètom èíselnıch buniek v rozsahu. 			
			  		<br>Príklad Average(a1;B2:C10)
          		<dt style="color:green">Max(zoznam oblastí oddelenıch bodkoèiarkou)
	  			<dd>Nájde maximálnu èíselnú hodnotu zo všetkıch vymenovanıch oblastí. 
		  			<br>Príklad MAX(a1;B2:C3) ... nájde maximum z A1,B2,B3,C2,C3
          		<dt style="color:green">Min(zoznam oblastí oddelenıch bodkoèiarkou)
	  			<dd>Nájde minimálnu èíselnú hodnotu zo všetkıch vymenovanıch oblastí. 
		  			<br>Príklad MIN(a1;B2:C3) ... nájde minimum z A1,B2,B3,C2,C3
          		<dt style="color:green; width:400">SUMIF(oblas podmienok; podmienka; oblas sèitovania)
           		<dd>oblas podmienok - oblas kde sa kontroluje podmienka
			  		<br>podmienka - buï hodnota, alebo testovacia otazka ako text v úvodzovkách
			  		<br>oblas súètu - oblas ktorá vytvára súèet
			  		<br>Je vlastne cyklus, kde beia ukazovatele na oboch oblastiach, ak prvá hodnota
			  		vyhovuje podmienke, druhá hodnota je pridaná do súètu. Je odporúèané voli obe oblasti
			  		rovnako poèetné.
			  		<br>Príklad 
			  		<table><tr><td>
			  				<table border="1" bgcolor="#F2F2F2" cellpadding="10"><tr bgcolor="#9696BF"><th>&nbsp;<th>A<th>B<th>C<th>D</tr>
			         		<tr><td bgcolor="#9696BF">1<td>1<td>15<td>&nbsp;<td>=sumif(a1:a5,1,b1:b5)</tr>
			         		<tr><td bgcolor="#9696BF">2<td>2<td>10<td>&nbsp;<td>&nbsp; </tr>
			         		<tr><td bgcolor="#9696BF">3<td>1<td>2<td>&nbsp;<td>&nbsp; </tr>
			         		<tr><td bgcolor="#9696BF">4<td>3<td>5<td>&nbsp;<td>&nbsp; </tr>
			         		<tr><td bgcolor="#9696BF">5<td>1<td>3<td>&nbsp;<td>&nbsp; </tr>
			  				</table>
			  				<td>V bunke D1 bude hodnota 20 získaná súètom 15+2+3 </tr>
			  		</table> 
			  		obr. 5
			  		<br>
          		<dt style="color:green">COUNTIF(oblast; podmienka)
	  			<dd>Podmienka: najjednoduhšia je iba uvedená hodnota, napr. 5, Jano, Pravda
		      		<br> &nbsp;&nbsp;&nbsp;&nbsp;môe by aj vıraz napr. E15 - nepíšeme rovná sa pred
		      		<br> &nbsp;&nbsp;&nbsp;&nbsp;okrem rovnosti môeme tvori podmienky pomocou relaènıch operátorov
		      		<font face="Keystroke" size="+2">&gt;,&lt; &gt;= &lt;= &lt;&gt;</font>, ale potom musí by podmienka ako textovı vıraz.
		      		Spoèíta poèet buniek v zadanej oblastí, ktoré spåòajú danú podmienku. 			
			  		<br>Príklad COUNTIF(B2:C10;1) ... spoèíta poèet 1 v oblasti B2:C10
			  		<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNTIF(B2:C10;"&lt;0") spoèíta poèet zápornıch èísel
          		<dt style="color:green;width:400">COUNTBLANK(zoznam oblastí oddelenıch bodkoèiarkou)
       			<dd>Zistí poèet prázdnych buniek vo vıbere
		  			<br> Príklad COUNTBLANK(a1;B2:C3) ... zistí poèet prázdnych buniek z A1,B2,B3,C2,C3
		   		<dt style="color:green">ROUND(vıraz; poèet des.)
				<dd>vyhodnotí danı vıraz a zaokrúhli ho pod¾a matematickıch pravidiel na danı poèet des. miest.
				  	<br>Príklad: Round(3,2, 0) -&gt; 3
				  	<br> Round(3,226; 2) -&gt; 3,23
		   		<dt style="color:green">ROUNDDOWN(vıraz; poèet des.)
				<dd>vyhodnotí danı vıraz a zaokrúhli ho nadol (smerom k nule)na danı poèet des. miest.
				  	<br>Príklad: RoundDown(3,6;0) -&gt; 3
				  	<br> RoundDown(3,226; 2) -&gt; 3.22
				  	<br> RoundDown(-3,6; 0) -&gt; -3.0
		   		<dt style="color:green">ROUNDUP(vıraz; poèet des.)
				<dd>vyhodnotí danı vıraz a zaokrúhli ho nahor (smerom od nuly)na danı poèet des. miest.
				  	<br>Príklad: RoundUP(3,6;0) -&gt; 4
				  	<br> RoundUp(3,226; 2) -&gt; 3.23
				  	<br> RoundUp(-3,6; 0) -&gt; -4.0
			  	<dt style="color:green;width:100%">ABS(vıraz), SIN(vıraz), COS(vıraz), TG(vıraz), EXP(vıraz),LN(vıraz),LOG(vıraz),PI() 
				<dd>
			    	štandartné matematické funkcie, pri goniometrickıch funkciách je argument samozrejme v radiánoch.
				<dt style="color:green">SUBTOTAL(èíslo_fun; oblas)
				<dd>Táto funkcia dokáe zastúpi viacero u spomenutıch funkcií ale pre svoju pomernú zloitos sa pouíva len v spojitosti
			    	s filtrovaním. Jej uplatnenie je v tom,	e do vısledku neberie riadky, ktoré nevyhovujú podmienke nastaveného filtra (pozri filtrovanie). 
					Napr. hodnota funkcie SUM sa nezmení aj keï nastavením filtra sa sa zníi poèet riadkov vıberu, ale hodnota
					funkcie SUBTOTAL(9;...) sa bude meni pod¾a zvoleného filtra. Funkcia má dva parametre:
					<br>1. urèuje èinnos funkcie
					<br>2. urèuje oblas
			  		<table cols="2" cellpadding="5" cellspacing="0"><tr align="center" bgcolor="Silver"><th>Èíslo funkce<th>Funkcia</tr>
                    <tr align="center"><td>1<td>AVERAGE</tr>
                    <tr align="center"><td>2<td>COUNT</tr>
                    <tr align="center"><td>3<td>COUNTa</tr>
                    <tr align="center"><td>4<td>MAX</tr>
                    <tr align="center"><td>5<td>MIN</tr>
					<tr align="center"><td>6<td>PRODUKT</tr>
					<tr align="center"><td>7<td>STDEV</tr>
					<tr align="center"><td>8<td>STDEVP</tr>
					<tr align="center"><td>9<td>SUM</tr>
                    <tr align="center"><td>10<td>VAR</tr>
					<tr align="center"><td>11<td>VARP</tr>
			 		</table>
        	</dl>
		   	<hr width="60%" size="2">
			<dt>Úlohy na precvièenie:
    		<dd><table cellspacing="20"><tr><td>
	    	   	<img src="obr/vitez.gif" border="0" alt="" height="50">
				<td>
	    		<ol>
				<li><a href="kratke/2_vzorce.xls" target="_blank">Krátke úlohy-suhrn</a>				   
				<li><a href="priklady/vzorce-sumif.xls" target="_blank">Úloha na sumif, countif</a>				   
				<li><a href="priklady/countif.xls" target="_blank">Úloha na sumif, countif</a>				   
				<li><a href="priklady/sumaif.xls" target="_blank">Úloha na sumif</a>				   
	        	<li>Navrhni tabu¾ku na evidovanie údajov iakov pre zdravotnı ústav, keï potrebujeme
	            	evidova meno, vıšku, váhu, pohl. Tabulka musí dovoli pripisova a editova údaje
	            	a zobrazova aktuálny stav - poèet iakov, poèet chlapcov, poèet dievèat, primerná vıška 
	            	clapcov, priemerná vıška dievèat.   
            	</ol>
				</tr>
            	</table>
		   		<hr width="60%" size="2">
			<dt>Logické funkcie
			<dd>
		      	<dl>
		      	<dt style="color:green">IF(podmienka;ano;nie)<dd>
			      	Pouíva sa ak obsah bunky sa má úplne meni pod¾a nejakej podmienky. 
			      	Vyhodnotí podmienku a ak je podmienka pravdivá vyhodnotí a zobrazí vıraz ano inak vyhodnotí a zobrazí vıraz nie
				  	<br>Príklad: IF(c5&gt;0;"kladné",if(c5&lt;0;"záporné";"nulové"))
		      	<dt style="color:green">AND(zoznam log. vırazov oddelenıch bodkoèiarkou)<dd>
			      	vyhodnotí log. vırazy a urobí medzi nimi operáciu <font color="Fuchsia">and</Font>
				  	Vısledkom je vıslednı logickı vıraz. Pouíva sa na tvorbu zloenıch podmienok.
				  	<br>Príklad: IF(AND(c5&gt;0,c5&quot),"vyhovuje","nevyhovuje")
		      	<dt style="color:green">OR(zoznam log. vırazov oddelenıch bodkoèiarkou)<dd>
			      	vyhodnotí log. vırazy a urobí medzi nimi operáciu <font color="Fuchsia">or</Font>
				  	Vısledkom je vıslednı logickı vıraz. Pouíva sa na tvorbu zloenıch podmienok.
				  	<br>Príklad: IF(OR(c5&gt;0;c6&gt;0),"aspon jedno kladné","ani jedno kladné")
		      	<dt style="color:green">NOT(logickı vıraz)<dd>
			      	vyhodnotí log. vırazy a urobí jeho <font color="Fuchsia"> negáciu</Font>
				  	Vısledkom je vıslednı logickı vıraz. Pouíva sa na tvorbu zloenıch podmienok.
				  	<br>Príklad: IF(NOT(c5&gt;0),"nekladné","kladné")
			  	</dl>	  
			<dt>Úlohy na precvièenie:
    			<dd><table cellspacing="20"><tr><td>
	        	<img src="obr/stastny.gif" border="0" alt="" height="50">
				<td>
	    		<ol>
				<li><a href="priklady/podmienka1.xls" target="_blank">krátke jednoduché úlohy</a>
				<li><a href="priklady/podmienka2.xls" target="_blank">úloha o 13. plate</a>
				<li><a href="priklady/funkcieif.xls" target="_blank">podmienenı súèet-poèet</a>
				<li><a href="kratke/4_podmienky.xls" target="_blank">Krátke úlohy-suhrn</a>				   
	        	<li>Navrhni tabulky na evidenciu známok pre polroèné vysvedèenie. Max. poèet známok je 12 a maximálny poèet iakov 35.
			    	Kadému iakovi vypoèítaj priemernú známku (ak nemá ešte naklepané známky údaj bude vyparafovanı znakm -)
					Kadému iakovi vytvor ståpec Celkové hodnotenie, kde bude zapísané PVYZ, PVD, P, NP (NP bude napísané èerveno).
	        	<li>Navrhni tabu¾ku na h¾adanie koreòa rovnice F(x)=0, na intervale &lt;a,b&gt;, prièom
			    	F(a)*F(b)&lt;0 a funkcia F je polynóm stupòa maximálne 5.
					<br>Koreò budeme h¾ada metódou polenia intervalu, prièom poèet delení je pevnı 100.
					<br>Vstup budú tvori: koeficienty polynomu a hodnoty a,b
					<br>Vıstup bude nájdenı koreò, zaruèená presnos, resp. pri nedodraní podmienky F(a)*F(b)&lt;0 oznam o chybe. 
            	</ol></tr>
            	</table>
			<dt>Dátumové a èasové funkcie<dd>
		      	<dl>
		      	<dt style="color:green">DATEVALUE(text), DATE(cislo_den, cislo_mes, cislo_rok)<dd>
					prevedie text (resp. 3 èísla) na dátum. Pouíva sa ak je dátum zapísanı roztrhnuto (den, mes, rok v samostatnıch ståpcoch)
					a potrebujeme vykona nejaké dátumové príkazy (zisti rozdiel dní, deò v tıdni a pod)
					<br>Príklad: DATEVALUE("25.03.2004")-DATEVALUE(11.09.2002) ... zistí poèet dní medzi dátumami
		      	<dt style="color:green">DEN(datumovı_vıraz)<dd>
					Z dátumu vie vytiahnu deò.
					<br>Príklad: DAY(DATEVALUE("25.03.2004")) -> 25
		      	<dt style="color:green">MONTH(dátumovı_vıraz)<dd>
					Z dátumu vie vytiahnu èíslo mesiaca.
					<br>Príklad: MONTH(DATEVALUE("25.03.2004")) -> 3
		      	<dt style="color:green">YEAR(dátumovı_vıraz)<dd>
					Z dátumu vie vytiahnu èíslo mesiaca.
					<br>Príklad: YEAR(DATEVALUE("25.03.2004")) -> 2004
		      	<dt style="color:green">WEEKDAY(dátumovı_vıraz;2) <span style="color:black">alebo</span> WEEKDAY(text;2)<dd>
					Z dátumu vie vytiahnu èíslo poradové èíslo dòa v tıdni 1=pondelok, ....
					<br>Príklad: WEEKDAY(DATEVALUE("25.03.2004")) -> 6
		      	<dt style="color:green">TODAY()<dd>
					Hodnotou je dnešnı dátum ako dátumová hodnota
					<br>Príklad: TODAY() -> vypíše napr. 27.03.2004
		      	<dt style="color:green">NOW()<dd>
					Hodnotou je dnešnı dátum a aktuálny èas
					<br>Príklad: NOW() -> vypíše napr. 27.03.2004 10:08
		      	<dt style="color:green">TIMEVALUE(text), ÈAS(cislo_hod, cislo_min, cislo_sek)<dd>
					prevedie text (resp. 3 èísla) na èasovı údaj.
		      	<dt style="color:green">HOUR(èasovı_vıraz)<dd>
					Z èasového údaja vie vytiahnu hodinu.
					<br>Príklad: HOUR(NOW()) -> 10
		      	<dt style="color:green">MINUTE(èasovı_vıraz)<dd>
					Z èasového údaja vie vytiahnu minutu.
					<br>Príklad: MINUTE(NOW()) -> 8
		      	<dt style="color:green">SECOND(èasovı_vıraz)<dd>
					Z èasového údaja vie vytiahnu sekundu.
					<br>Príklad: SECOND(NOW()) -> 15
				</dl>
   	<hr width="80%" size="4">
	<dt>Písanie vnorenıch funkcií
	<dd><br>Èasto sa stane e namiesto niektorého argumenta funkcie potrebujeme vloi vısledok nejakej funkcie (jedna funkcia bude vnútri inej).
		Pokia¾ vnorenú funkciu vieme korektne zapísa nie je problém:
		<ul><li>Zaèneme vytváraním vonkajšej funkcie 
			<li>Do riadka pre parameter naklepeme funkciu (tu sa musíme spo¾ahnú na svoju pamä a napísa ju správne)
				<br>(napríklad vo funkcii IF() do riadka pre podmienku naklepeme OR(a1&gt;0; A2&gt;0)
		</ul>
		<br>Pokia¾ si vnorenú funkciu netrúfame korektne zapísa sami a chceme zavola "pomocníka"="dialogóvé okno" pouijeme nasledovnı postup:
		<ul><li>Zaèneme vytváraním vonkajšej funkcie (napr. funkcia IF)
			<li>nastavíme sa do riadku parameter
			<li>rozbalíme ponuku "adresné pole" a vyberieme funkciu (napr. OR), ak tam nie je zvolíme "ïalšie funkcie"
			<li>po zvolení funkcie sa zavolá dialógové okno a my nastavujeme parametre vnútornej funkcie
			<li>po zadaní parametrov stlaèíme "OK" okno sa zavrie a nami zadaná funkcia sa korektne zapíše na miesto parametra vonkajšej funkcie
		</ul>
		<br>Pozn.:
		<br>Funkcie mono do seba vnára do håbky 7.	   
				
</dl>
</body>
</html>
