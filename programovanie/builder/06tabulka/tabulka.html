<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
	<meta name="Content-language" content="sk"> 
	<meta name="keywords" content="programovanie, Delphi, Jaroslav, Mikuláš" >
	<META http-equiv="Page-Enter" content="blendTrans(Duration=1)">
	<LINK href="../css/style.css" type="text/css" rel=stylesheet>
</head>

<body>
<h3>Objekt StringGrid </h3>
<dl>
	<dt class=main>Popis
	<dd>StringGrid je objekt podobnı objektu memo, len ku údajom mono pristupova
		cez riadky alebo aj cez ståpce. Kadı riadok (ståpec) je typu Tstrings, èo je rovnakı
		typ ako memo1 a sú to stringy oddelené znakom Enter (#13). Font mono nastavi pre 
		celú tabu¾ku (je moné zobrazovanie inım fontom cez Canvas). Podobne ako v Exceli mono vytvori nieko¾ko prvıch ståpcov
		aj riadkov ako hlavièky, ktoré budú vyma¾ované šedou farbou a uívate¾ sa do nich nedostane
		(ich hodnota sa mení len príkazmi programu). Biele bunky mono povoli editova alebo nepovoli.    
		<br>Jedna bunka je vdy aktívna a je zvıraznená orámovaním, jej poloha je zapísaná vo vlastnostiach
		Row, Col. Pohyb po tabulke mono robi klávesovımi šipkami.
	<dt class=main>Premenné - vlastnosti<dd>
	<ul>
	<li><b>ColCount</b> - poèet ståpcov tabu¾ky 
	<li><b>RowCount</b> - poèet riadkov tabu¾ky
	<li><b>Col</b> - aktuálny ståpec
	<li><b>Row</b> - aktuálny riadok
	<li><b>FixedCols</b> - poèet nepohyblivıch ståpcov (šedıch)
	<li><b>FixedRows</b> - poèet nepohyblivıch riadkov (šedıch)
	<li><b>LeftCol</b> - Index prvého scrolujúceho ståpca
	<li><b>TopRow</b> - Index prvého scrolujúceho riadka
	<li><b>Cells[s,r]</b> - string v bunke [s,r]
	<li><b>Cols[s]</b> - stringy v stpci s odelené znakom #13
	<li><b>Rows[r]</b> - stringy v riadku r oddelené znakom #13
	<li><b>MouseToCell(x,y,Var s,r)</b> - adresa bunky, kde sme klikli
	<li><b>Options</b> -<ul>
		<li>gocolsizing - ruèná zmena šírky ståpca
		<li>gorowsizing - ruèná zmena vıšky ståpca
		<li>goediting - povoli ruènú zmenu bunky
		<li>GoAlwaysShawEditor - ak je true po vojdení do bunky sme hneï v editovacom reime
		<li>gotabs - povoli presun medzi bunkami cez tab
				</ul>
	</ul>
	Štandartne nechávame na Builder, aby  
	<ul><li>zvırazòovali vybrané bunky
		<li>vypisovali obsah buniek v bunkách
	</ul>
	lebo je to jednoduchšie. Nevıhodou ale je, e všetky texty sú v bunkách zarovnané z¾ava a pouitı bude jeden typ písma, èo môe
	excelovım odchovancom "trha ily". Existuje monos pomocou udalosti 
	<br><b>OnDrawCell()</b>
	<br>zmeni spôsob zápisu a zapísa text pomocou metódy 
	<br><b>StringGrid1.Canvas.TextRect()</b>, 
	<br>kde je moné vıpoètom zabezpeèi zarovnanie na stred alebo vpravo.
	<br>Je moné si vytvori ešte jeden StringGrid (neviditelnı), kde v bunkách bude zapísanı font akım je 
	bunka vo viditelnej tabu¾ke zobrazovaná.
	<br>Ukáka zarovnania vpravo
	<div style="border-width:3;border-style:outset;width:910px;margin:10px;background-color:#dddddd;">
   <div align="left" style="background-color:#3366ff; width:910px; padding:0;border-width:0;color:white">Unit1.cpp
   </div>
   <div style="background-color:#dddddd; width:690px;" >
   <div style="margin:10px">
<pre>
void __fastcall TForm1::StringGrid1DrawCell(TObject *Sender, int ACol, int ARow, TRect &Rect, TGridDrawState State)
{  int WidthOfText, WidthOfCell, LeftOffset; 
   string text;
   text = StringGrid1->Cells[ACol,ARow];
   WidthOfText = StringGrid1->Canvas->TextWidth(Cells[ACol,ARow]);
   WidthOfCell = StringGrid1->ColWidths[ACol];
   LeftOffset = max(WidthOfCell - WidthOfText,0);
   StringGrid1->Canvas->TextRect(Rect,Rect.Left+LeftOffset,Rect.Top,Cells[ACol,ARow]);
}
</pre></div>
</div></div>	
<dt>Save, Load dát tabu¾ky
<dd>Na rozdiel od mema, kde existuje metóda SaveToFile(), ktorá zapíše celı obsah mema do súboru, tu takú jednoduchú monos
	nemáme. Najjednoduchšia cesta vyzerá by pouitie textového súboru a zapísa doò obsah tabu¾ky po riadkoch. Ak sme volili
	v bunkách rôzne fonty musíme ich samozrejme tie zapísa (ïalej uvaujem, e celá tabu¾ka má jeden typ písma).
	Je potrebné do súboru zapísa aj poèet riadkov a ståpcov tabu¾ky.
	<br>Celé to môe vyzera asi takto:
	<div style="border-width:3;border-style:outset;width:910px;margin:10px;background-color:#dddddd;">
   <div align="left" style="background-color:#3366ff; width:910px; padding:0;border-width:0;color:white">Unit1.cpp
   </div>
   <div style="background-color:#dddddd; width:690px;" >
   <div style="margin:10px">
<pre>
// Save a TStringGrid to a file
void SaveStringGrid(StringGrid: TStringGrid; const FileName: TFileName);
{  ofstream f;
   f.open(FileName);
   f &lt;&lt;StringGrid->ColCount &lt;&lt; ' ' &lt;&lt; StringGrid->RowCount&lt;&lt;endl;
   for (int i=0; i&lt;StringGrid->RowCount; i++)
      for (int k=0; k&lt;StringGrid->ColCount; k++)
	      f &lt;&lt; StringGrid->Cells[i,k] &lt;&lt;endl;
      f.close();	  
}
// Load a TStringGrid from a file
void LoadStringGrid(StringGrid: TStringGrid; const FileName: TFileName);
{  ifstream f;
   f.open(FileName);
   f &gt;&gt;StringGrid->ColCount &gt;&gt; StringGrid->RowCount;
   f.getline(StringGrid->Cells[0,0],255);
   for (int i=0; i&lt;StringGrid->RowCount; i++)
      for (int k=0; k&lt;StringGrid->ColCount; k++)
	      f.getline(StringGrid->Cells[i,k],255);
   f.close();	  
}
</pre></div></div></div>

	<dt class=main>Príklady na precvièenie:
	<dd><table cellspacing="20"><tr><td>
		<img src="../obr/ktstrofa.wmf" border="0" alt="" height="50">		
		<td>1. Vytvor nasledovnı program
		<br><a href="knihy.exe">stiahnu</a>		
		<br>2. Vytvor nasledovnı program - piškvorky
		<br><a href="pisk.exe">stiahnu</a></tr>		
		</table>		
</dl>


</body>
</html>
