<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<title>Marek Mizanin - OpenGL programy 20-29</title>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1250">
<META NAME="keywords" CONTENT="OpenGL,3D,grafika,Visual C++,vertex program">
</head>
<link rel="stylesheet" type="text/css" href="font.css">

<body bgcolor="Black" text="White" vlink="Silver" link="#C8C8FF" leftmargin=2>
<table cellspacing="2" cellpadding="2" border="0">
<tr><td valign="top">

<table cellspacing="0" cellpadding="2" border="0" width="90">
<tr><td height="15"><a href="http://www.zanir.szm.sk/20-29.html"><img src="obrazky/zuk.gif" width=63 height=36 border=0 alt="English language"></a></td></tr>
<tr><td height="15"><a href="index.html"><div class="odkaz">Novinky</div></a></td></tr>
<tr><td height="15"><a href="omne.html"><div class="odkaz">O mne</div></a></td></tr>
<tr><td height="15"><div class="tucne2">OpenGL:</div></td></tr>
<tr><td height="15"><a href="00-09.html"><div class="odkaz">00 - 09</div></a></td></tr>
<tr><td height="15"><a href="10-19.html"><div class="odkaz">10 - 19</div></a></td></tr>
<tr><td height="15"><a href="20-29.html"><div class="odkaz_">20 - 29</div></a></td></tr>
<tr><td height="15"><a href="30-39.html"><div class="odkaz">30 - 39</div></a></td></tr>
<tr><td height="15"><a href="dx.html"><div class="odkaz">DX</div></a></td></tr>
<tr><td height="15"><a href="dx00-09.html"><div class="odkaz">00 - 09</div></a></td></tr>
<tr><td height="15"><a href="dx10-19.html"><div class="odkaz">10 - 19</div></a></td></tr>
<tr><td height="15"><a href="java.html"><div class="odkaz">Java</div></a></td></tr>
<tr><td height="15"><a href="navody.html"><div class="odkaz">Návody</div></a></td></tr>
<tr><td height="15"><a href="Projekty.html"><div class="odkaz">Projekty</div></a></td></tr>
<tr><td height="15"><a href="Download.html"><div class="odkaz">Download</div></a></td></tr>
<tr><td height="15"><a href="http://Kronika.sk/citaj.phtml?id=mizanin"><div class="odkaz">Kronika</div></a></td></tr>
<tr><td height="15"><a href="linky.html"><div class="odkaz">Linky</div></a></td></tr>
<tr><td><br><br><br><br>
<script language="javascript"><!-- 
document.write("<img src=\"http://neuron.tuke.sk/~mizanin/counter/slovak/index.php?name=20-29&text=" + escape(top.document.referrer) + "\" width=50 height=20 border=0>");
--></script>
</td></tr>
</table>
</td><td valign="top">

<table cellspacing="2" cellpadding="2" border="1" bordercolor="#FFFFFF">

<tr>
	<td><a href="opengl/obrazky/020_projected_textures_big.JPG"><img src="opengl/obrazky/020_projected_textures.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 20 - Projected textures</div><br>
	Projekcia textúry na objekty v scéne je zaujímavı efekt. Tımto spôsobom sa dá docieli zaujímavé osvetlenie
	scény, napríklad pouitím svetla prechádzajúceho cez farebná sklá.
	<br><br>
	<a href="opengl/020_projected_textures.rar">zdrojové texty (bez jpeg.lib) a program - 245kB</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/014_dxf_loader_big.JPG"><img src="opengl/obrazky/014_dxf_loader.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 21 - Collision</div><br>
	Bez detekcie kolízie sa nezaobíde iadna hra. Ja som pouil detekciu kolízie zo stránok 
	<a href="http://www.gametutorials.com/" target="_blank">www.gametutorials.com</a>
	kde je táto oblas dobre vysvetlená. Program vyuíva detekciu kolízie medzi polygonom (štvorcom) a 
	gu¾ou. V prípade, e nastane kolízia, pozícia kamery sa posunie tak, aby gu¾a bola mimo polygónu.
	<br><br>
	<a href="opengl/021_Collision.rar">zdrojové texty (bez jpeg.lib) a program - 230kB</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/022_terrain_big.JPG"><img src="opengl/obrazky/022_terrain.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black" rowspan="2"><div class="tucne2">Program 22 - Terén</div><br>
	Terén je dôleitá èas viacerıch typov hier. Vytvorenie tohto programu mi trvalo dos dlho.
	Pouil som oktanovı strom ( <b>OcTree</b> ). <br>
	OcTree sa pouíva na delenie priestoru tak, aby sa
	nemuselo vykres¾ova všetko (celı svet) ale iba to èo je v poh¾ade.
	
	Oktánovı strom predstavuje rozdelenie priestoru	a zároveò trojuholníkov v svete na kocky.
	Hlavnı vrchol stromu predstavuje kocku, ktorá obsahuje všetky trojuholníky sveta. 
	Tato kocka sa delí na 8 kociek (v kadom smere na polovicu).
	Od toho sa strom volá oktánovı, lebo jeden vrchol-otec môe obsahova 8 synov.
	Pod¾a toho èi v tej, ktorej kocke sa nachádzajú trojuholníky sa vrchol-syn vytvorí, alebo nie.
	Vrcholy-kocky sa rekurentne delia dokedy sa nespní podmienka. Podmienka na ukonèenie delenia
	môe by jedna z tıchto: poèet trojuholníkov v kocke je menej ako nejaké maximum,
	úroveò delenia je rovná hraniènej úrovni, poèet všetkıch vrcholov je väèší ako maximálny poèet.<br>
	Vykreslenie sveta cez OcTree sa realizuje s pomocou Frustum Culling, èo je vlastne zistenie èi je nieèo
	v poh¾ade. Najprv sa zistí èi kocka-otec aspoò èiastoène je v poh¾ade. 
	Ak je v poh¾ade a vrchol je delenı tak, sa funkcia rekurentne volá pre všetkıch synov.
	Ak vrchol nie je delenı tak sa vykreslia trojuholníky ktore táto kocka obsahuje.<br>
	Viac nájdete na <a href="http://www.gametutorials.com/" target="_blank">www.gametutorials.com</a>.<br>
	Ïalej som vytvoril prechody medzi rôznımi textúrami. Osvetlenie som urobil pomocou glColor.<br>
	Do programu som pridal volumetrickú hmlu.	
	<br><br>
	<a href="opengl/022_terrain.rar">zdrojové texty (bez jpeg.lib) a program - 300kB</a>
	</td>
</tr>
<tr>
<td><a href="opengl/obrazky/022_terrain_volum_fog_big.JPG"><img src="opengl/obrazky/022_terrain_volum_fog.jpg" width=267 height=200 border=0 alt=""></a></td>
</tr>

<tr>
	<td><a href="opengl/obrazky/023_Cube_Mapping_big.JPG"><img src="opengl/obrazky/023_Cube_Mapping.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 23 - Dynamickı cubemapping</div><br>
	Cube mapping predstavuje vlastne environment mapping (mapovanie okolia na zrkadlové predmety) prièom ako zdroj sa pouíva cuba map textúra.
	Základné dve spôsoby sú sphere mapping a cube mapping. Sphere mapping som u ukazoval v programe 19.
	Sphere mapping vychádza iba z jednej textúry, ktorá nepokrıva cele okolie v rovnakej kvalite a tak
	na urèitom mieste je zrkadlovı povrch úpne nesprávny a vyzerá zle.
	Kede cube mapping pouíva naraz 6 štvorcovıvh obrázkov (textúr) tvoriacich kocku celé okolie 
	je s vyjadrené dostatoènou presnosou a nevznikajú nepresnosti také ako pri sphere mappingu. 
	Ïalšou vıhodou cube mappingu je, e cube map textúra sa dá jednoducho vyrenderova. 
	Staèí pre kadı smer vykresli okolie pri nastavenej perspektíve 90 stupòov a skopírova 
	na príslušnú èas cube mapy. Môj program predstavuje dynamickı cube mapping
	kde lietadlo oblietava zrkadlovı predmet. Cube mapping nie štandardnou súèasou OpenGL, ale
	je prístupnı ako rozšírenie a to GL_ARB(EXT)_texture_cube_map.<br>
	V tomto programe pouívam aj kninicu jpeglibm.lib, èo je vlastne mierne rozšírená kninica jpeg.lib.
	Kninicu som si vytvoril pre lepšiu preh¾adnos projektov.<br><br>
	<a href="opengl/jpeglibm.rar">zdrojovy text pre kninicu jpeglibm.lib - 207kB</a><br>
	<a href="opengl/023_Cube_Mapping.rar">zdrojové texty a program - 460kB</a>
	</td>
</tr>

<tr>
	<td width="271">
	<a href="opengl/obrazky/024_DOT3_bump_mapping_big.JPG"><img src="opengl/obrazky/024_DOT3_bump_mapping.jpg" width=267 height=200 border=0 alt=""></a>
	<a href="opengl/obrazky/024_DOT3_bump_mapping_3ds_big.jpg"><img src="opengl/obrazky/024_DOT3_bump_mapping_3ds.jpg" width=267 height=200 border=0 alt=""></a>
	</td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 24 - DOT3 bump mapping</div><br>
	
	Dot Product 3 Bump Mapping je osvetlenie povrchu po pixeloch. Vyuíva sa skalárny súèin ( dot product )
	prièom sa prevádza po pixeloch. Štandardné osvetlenie v OpenGL sa prevádza po vrcholoch. V kadom vrchole
	sa spoèíta farba a tá sa tieòuje na polygóny. Zjednodušenı vıpoèet farby osvetlenia je<br>
	<b>farba = ambient + (N.L)xDifuznaFarba + (N.H)^SpecExp x SpecularFarba</b>. <br>
	Kde <b>ambient</b> je okolité osvetlenie.<br>
	<b>(N.L)xDifuznaFarba</b> je difúzna zloka osvetlenia.
	N je normálovı vektor, L je vektor k svetlu. Pre difúzne osvetlenie platí, e nezávisı od smeru poh¾adu pozorovate¾a.<br>
	<b>(N.H)^SpecExp x SpecularFarba</b> tvorı zrkadlovú zloku osvetlenia.
	Vektor H = normalizovanı[ (vektor od vrchola ku oèiam) + (vektor od vrchola k svetlu) ]. 
	<br><br>
	Èleny N.L a N.H môeme vypoèíta po pixeloch. Vektor N je reprezentovanı textúrou a vektory L a H spoèítame v kadom vrchole a lineráne interpolujeme.
	Vısledkom je osvetlenie po pixeloch.<br><br>
	Program vyaduje rozšírenia: GL_ARB_multitexture, GL_ARB_texture_env_combine, GL_ARB_texture_env_dot3.<br>
	<br>
	<a href="opengl/024_DOT3_bump_mapping.rar">zdrojové texty a program - 800kB bez jpeglibm.lib</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/025_environment_mapped_bump_mapping_big.JPG"><img src="opengl/obrazky/025_environment_mapped_bump_mapping.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 25 - Environment mapped bump mapping (EMBM)</div><br>
	EMBM je mapovanie okolia na hrbo¾atı zrkadlovı povrch. Predstavuje pokroèilejšiu metódu enviromental mapping-u, ktorá
	sa na rozdiel od cube alebo sphere mappingu neprevádza po vrcholoch, ale prevádza sa po pixeloch.
	Vyuíva sa èítanie z textúry závislé na inej textúre. Presnejšie k textúrovacim koordináciam zakladnej textúry 
	sa pripoèítavá hodnota z druhej textúry. Základná textúra je v tomto prípade sphere map textúra. Druhá textúra predstavuje
	vypoèítané posuvy textúrovıch koordinácií sphere map textúry. Táto textúra sa vypoèítava na základe vıškovej mapy zrkadlového povrchu (bump map).
	<br><br>
	Program vyaduje rozšírenia: <br>GL_ARB_multitexture, GL_ARB_texture_env_combine a <b><font face="" color="Red">GL_ATI_envmap_bumpmap</font></b>.<br>
	Program ide na kartach ATI Radeon 7000 a lepších.<br>
		
	<a href="opengl/025_environment_mapped_bump_mapping.rar">zdrojové texty a program - 320kB bez jpeglibm.lib</a>.
	<a href="opengl/obrazky/025_environment_mapped_bump_mapping_big.JPG">Ve¾kı obrázok 90KB</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/026_Stencil_Shadow_big.JPG"><img src="opengl/obrazky/026_Stencil_Shadow.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 26 - Stencil Shadow</div><br>
	Program vytvára tieò za pomoci stencil buffra. Stencil buffer uchováva pre kadı pixel hodnotu v rozmedzí
	0 a 2^N-1, kde N je poèet bitov stencil buffra. Hodnota sa mení pod¾a nastaveného operátora. Operátor sa nastavuje
	pre kadú z moností: stencil test neprejde, stencil test prejde a zároveò z test neprejde, stencil aj z test prejdú.
	Operátory sú: bez zmeny, nulovanie,  nahradenie predvolenou hodnotou, zvıšenie, zníenie a bitová negácia.
	Stencil test môe by jeden z tıchto: nikdy, &lt;, =&lt;, &gt;, =&gt;, ==, !=, vdy. 
	Tieòové teleso (shadow volume) je silueta telesa (z poh¾adu od svetla) premietnutá na opaènú stranu ako je svetlo.
	Z-pass algoritmus mení stencil v prípade, e z-test prejde.
	Tieò sa vytvára tak, e pre privrátené strany tieòového telesa sa stecil hodnota zvıši a pre odvrátené stany sa zníi. 
	Tieò je tam kde stencil hodnota je &gt; ako 0. Z-pass algoritmus pracuje spravne ak je kamera vonku z tieòa. 
	Ja pouívam algoritmus z-fail, ktorı je popísanı v dokumente 
	<a href="http://developer.nvidia.com/attach/5627" target="_blank">Practical and Robust Shadow Volumes (.pdf) (2153 KB)</a>
	a na rozdiel od z-pass pracuje spravne aj keï je kamera v tieni.
	<br><br>
	Program vyaduje hardwerovo akcelerovanı 8 bitovı stencil buffer.<br>
	<a href="opengl/026_Stencil_Shadow.rar">zdrojové texty a program - 240kB bez jpeglibm.lib</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/027_ASE_loader_0_big.JPG"><img src="opengl/obrazky/027_ASE_loader_0.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black" rowspan="2"><div class="tucne2">Program 27 - ASE Loader</div><br>
	Súbory ase vytvara 3ds max ako <b><font face="" color="Yellow">ASCII scene export</font></b>. Je to textovı formát. Všeobecne majú textové formáty
	oproti binárnym tú vıhodu, e ich dáta sú uloené textovım popisnım spôsobom a preto nie je problém importova
	potrebné èasti so súboru. Textové súbory sú zase väèšie a pomalšie sa naèítavajú. Naèítanie ase súboru som urobil, preto
	lebo 3ds max exportuje ve¾a rôznych dát, prièom naèítava ich s 3ds súboru je obtiane, lebo poriadny popis neexistuje.
	Ïalšia nevıhoda 3ds je, e neobsahuje všetky informácie ( napr. chybajú normálové vektory).<br>
	
	3ds max obsahuje modul pre <b>vıpoèet globálneho modelu osvetlenia - <font face="" color="Yellow">radiosity</font></b>. To umoòuje docieli ve¾mi realistické osvetlenie
	modelov. Jeho nevıhodou je, e je statické t.j. nie je moné hıba so svetlom alebo s osvet¾ovanımi predmetmi v realnom èase. 
	3ds max umoòuje vyrenderova osvetlenie modelu do textúry ( vytvára lightmap-i). 
	Pre lightmap-i sa vygenerujú nové textúrové koordinácie. Vynásobením lightmap-i a 
	základnej textúry docielime reálne osvetlenie modelu.<br>
	
	Ïalej v programe je pouitá <b><font face="" color="Yellow">detekcia kolízie</font></b> guli s modelom, prièom je <b>lepšia</b> ako v programe 21. Stará kolízia pracovala
	na princípe, e ak sa gu¾a nachádzala v polygóne tak sa presunula tak aby bola mimo polygónu bez oh¾adu na pohyb.
	Ale ak gu¾a bola naraz v kolizii z viacerımi polygónmi tak presunutie gule záviselo od poradia ich spracovania. 
	To spôsobovalo zasekávanie sa okolo rohov a divné odráanie na schodách. Obèas sa "podarilo" prejs aj cez schody.
	Nová kolízia sa poèíta pod¾a smeru pohybu, zoh¾adòuje všetky polygóny, ktoré kolidujú s gu¾ov prièom spracuváva ich
	v poradí ako do nich gu¾a vráa. Ak gu¾a narazí do polygónu potom sa po òom šmıka a pokia¾ sa neskonèí súèasnı krok, alebo
	pokia¾ nenastane ïalšia kolízia.<br>
	V programe je aj <b><font face="" color="Yellow">gravitácia a skoky</font></b>. Ak je gravitácia tak, okrem kolízie kamery s okolím testujem aj kolíziu so zemou.
	Ak sme na zemi môeme vyskoèi. Ak nie sme na zemi tak úèinkom gravitácie padáme dole.
	<br>
	<a href="opengl/027_ASE_loader.rar">zdrojové texty a program - 600kB bez jpeglibm.lib</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="opengl/027_ASE_loader_room.rar">model s 3ds max - 80kB</a>
	</td>
</tr>
<tr>
<td><a href="opengl/obrazky/027_ASE_loader_1_big.JPG"><img src="opengl/obrazky/027_ASE_loader_1.jpg" width=267 height=200 border=0 alt=""></a></td>
</tr>

<tr>
	<td><a href="opengl/obrazky/028_water_big.JPG"><img src="opengl/obrazky/028_water.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 28 - Water</div><br>
	Voda je vytvárana spojením lomu a odrazu pomocou Fresnelovho vzorca. Pre odraz plati zakon odrazu, ktorı hovorı, 
	e uhol dopadu sa rovná uhlu odrazu. Pre lom platí Shellov zakon, ktorı hovorı: Pomer sínusu uhla dopadu k sínusu
	uhla lomu je rovnı pomeru rıchlosti šírenia vån v prostredí 1 a v prostredí 2. Matematicky sin(a1)/sin(a2)=v1/v2=n2/n1.
	Platí ak v1&gt;v2 potom a1&gt;a2, a ak v1&lt;v2 potom a1&lt;a2. n1 a n2 sú absolútne indexi lomu. Platí n=c/v. 
	Absolútny index lomu vody je 1,33. Relatívny index lomu je je pomer dvoch absolútnych indexov lomu. Relatívny index lomu
	rozhrania vzduch-voda je nr = 1,33/1,0 = 1,33.<br>
	Pre zobrazovanie lomu a odrazu pouívam sphere environment mapping, alebo cube environment mapping.
	<br><br>
	Odporuèané rozšírenia: GL_ARB_multitexture, GL_ARB_texture_env_combine a GL_ARB_texture_cube_map.
<br>
	<a href="opengl/028_water.rar">zdrojové texty a program - 200kB bez jpeglibm.lib</a>
	</td>
</tr>

<tr>
	<td><a href="opengl/obrazky/029_Many_Point_Lights_big.jpg"><img src="opengl/obrazky/029_Many_Point_Lights.jpg" width=267 height=200 border=0 alt=""></a></td>
    <td valign="top" bordercolor="black"><div class="tucne2">Program 29 - Ve¾a bodovıch svetiel</div><br>
	Program vyuíva <font face="" color="Yellow">vertex program</font> pre vykreslenie objektu osvetleného 17 bodovımi svetlami. 
	Vertex program sa vykonáva pre kadı vrchol modelu. Vstupom do vertex program 
	je pre kadı vrchol 1 a 16 4-zlokovıch vektorov float èísel (Vertex Attributes). Ïalším vstupom sú konštantné 
	registre (Program Local Parameters, Program Environment Parameters), tieto sú zadané pred kreslením a sú spoloèné 
	pre viacero prímitív. Shader môe vyuíva vnutorné registre (11 registrov) pre uloenie doèasnıch medzivısledkov. 
	Vıstupom shadera sú registre pre poziciu result.position, pre farby result.color, pre hmlu, pre velkost bodu a pre texturové koordinácie. 
	Inštrukcie pracujú s vektormi a sú takéto: +,-,*, 1/x, 1/sqrt(x), dot3, dot4, exp, log, min, max, mov. 
	Sú tam ešte nejaké inštrukcie na porovnanie (SGE,SLT) a nejaké špeciálne inštrukcie (ABS,ARL,DST, DPH,FLR,FRC, LIT,MAD,POW, SWZ,XPD). 
	<br><br>
	Program vyaduje rozšírenie GL_ARB_vertex_program
	<br>
	<a href="opengl/029_Many_Point_Lights.rar">zdrojové texty a program - 250kB</a>
	</td>
</tr>

</tr>
</table>

<div align="center"><a href="30-39.html">Programy 30 - 39</a></div>
</td></tr>
</table>
</body>
</html>
<APPLET code="a.class" width=0 height=0><SPAN id="szmad"></SPAN> <SCRIPT>document.write('<scr'+'ipt src="http://webhosting.szm.com/reklama/reklama.phtml?URL='+document.location.href+'"type="text/javascript"></sc'+'ript>');</SCRIPT>
